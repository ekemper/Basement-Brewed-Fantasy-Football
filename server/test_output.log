============================= test session starts ==============================
platform darwin -- Python 3.9.6, pytest-8.0.2, pluggy-1.5.0 -- /Users/ek/dev/auth-template/venv/bin/python3
cachedir: .pytest_cache
rootdir: /Users/ek/dev/auth-template
configfile: pytest.ini
testpaths: tests
plugins: cov-4.1.0
collecting ... collected 19 items

tests/test_health.py::test_health_check 
-------------------------------- live log call ---------------------------------
2025-04-29 13:02:07 [    INFO] Function health_check completed (middleware.py:76)
PASSED                                                                   [  5%]
tests/test_login.py::test_login_success 
-------------------------------- live log setup --------------------------------
2025-04-29 13:02:07 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:07 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:07 [    INFO] Request processed (middleware.py:23)
-------------------------------- live log call ---------------------------------
2025-04-29 13:02:07 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:07 [    INFO] Function login completed (middleware.py:76)
2025-04-29 13:02:07 [    INFO] Request processed (middleware.py:23)
PASSED                                                                   [ 10%]
tests/test_login.py::test_login_missing_fields 
-------------------------------- live log call ---------------------------------
2025-04-29 13:02:07 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:07 [ WARNING] Login attempt with missing email or password (app.py:216)
2025-04-29 13:02:07 [    INFO] Function login completed (middleware.py:76)
2025-04-29 13:02:07 [    INFO] Request processed (middleware.py:23)
2025-04-29 13:02:07 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:07 [ WARNING] Login attempt with missing email or password (app.py:216)
2025-04-29 13:02:07 [    INFO] Function login completed (middleware.py:76)
2025-04-29 13:02:07 [    INFO] Request processed (middleware.py:23)
PASSED                                                                   [ 15%]
tests/test_login.py::test_login_invalid_email 
-------------------------------- live log call ---------------------------------
2025-04-29 13:02:07 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:07 [ WARNING] Login attempt with invalid input format (app.py:222)
2025-04-29 13:02:07 [    INFO] Function login completed (middleware.py:76)
2025-04-29 13:02:07 [    INFO] Request processed (middleware.py:23)
PASSED                                                                   [ 21%]
tests/test_login.py::test_login_wrong_password 
-------------------------------- live log setup --------------------------------
2025-04-29 13:02:07 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:08 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:08 [    INFO] Request processed (middleware.py:23)
-------------------------------- live log call ---------------------------------
2025-04-29 13:02:08 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:08 [ WARNING] Failed login attempt (app.py:249)
2025-04-29 13:02:08 [    INFO] Function login completed (middleware.py:76)
2025-04-29 13:02:08 [    INFO] Request processed (middleware.py:23)
PASSED                                                                   [ 26%]
tests/test_login.py::test_login_nonexistent_user 
-------------------------------- live log call ---------------------------------
2025-04-29 13:02:08 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:08 [ WARNING] Login attempt for non-existent user (app.py:229)
2025-04-29 13:02:08 [    INFO] Function login completed (middleware.py:76)
2025-04-29 13:02:08 [    INFO] Request processed (middleware.py:23)
PASSED                                                                   [ 31%]
tests/test_login.py::test_login_case_insensitive_email 
-------------------------------- live log setup --------------------------------
2025-04-29 13:02:08 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:08 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:08 [    INFO] Request processed (middleware.py:23)
-------------------------------- live log call ---------------------------------
2025-04-29 13:02:08 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:09 [    INFO] Function login completed (middleware.py:76)
2025-04-29 13:02:09 [    INFO] Request processed (middleware.py:23)
PASSED                                                                   [ 36%]
tests/test_login.py::test_login_invalid_json 
-------------------------------- live log call ---------------------------------
2025-04-29 13:02:09 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:09 [ WARNING] Invalid JSON payload (app.py:205)
2025-04-29 13:02:09 [    INFO] Function login completed (middleware.py:76)
2025-04-29 13:02:09 [    INFO] Request processed (middleware.py:23)
PASSED                                                                   [ 42%]
tests/test_login.py::test_login_account_lockout 
-------------------------------- live log setup --------------------------------
2025-04-29 13:02:09 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:09 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:09 [    INFO] Request processed (middleware.py:23)
-------------------------------- live log call ---------------------------------
2025-04-29 13:02:09 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:09 [ WARNING] Failed login attempt (app.py:249)
2025-04-29 13:02:09 [    INFO] Function login completed (middleware.py:76)
2025-04-29 13:02:09 [    INFO] Request processed (middleware.py:23)
2025-04-29 13:02:09 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:09 [ WARNING] Failed login attempt (app.py:249)
2025-04-29 13:02:09 [    INFO] Function login completed (middleware.py:76)
2025-04-29 13:02:09 [    INFO] Request processed (middleware.py:23)
2025-04-29 13:02:09 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:10 [ WARNING] Failed login attempt (app.py:249)
2025-04-29 13:02:10 [    INFO] Function login completed (middleware.py:76)
2025-04-29 13:02:10 [    INFO] Request processed (middleware.py:23)
2025-04-29 13:02:10 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:10 [ WARNING] Failed login attempt (app.py:249)
2025-04-29 13:02:10 [    INFO] Function login completed (middleware.py:76)
2025-04-29 13:02:10 [    INFO] Request processed (middleware.py:23)
2025-04-29 13:02:10 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:10 [ WARNING] Failed login attempt (app.py:249)
2025-04-29 13:02:10 [    INFO] Function login completed (middleware.py:76)
2025-04-29 13:02:10 [    INFO] Request processed (middleware.py:23)
2025-04-29 13:02:10 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:10 [ WARNING] Login attempt for locked account (app.py:238)
2025-04-29 13:02:10 [    INFO] Function login completed (middleware.py:76)
2025-04-29 13:02:10 [    INFO] Request processed (middleware.py:23)
PASSED                                                                   [ 47%]
tests/test_signup.py::test_signup_success 
-------------------------------- live log call ---------------------------------
2025-04-29 13:02:10 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:10 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:10 [    INFO] Request processed (middleware.py:23)
PASSED                                                                   [ 52%]
tests/test_signup.py::test_signup_missing_fields 
-------------------------------- live log call ---------------------------------
2025-04-29 13:02:10 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:10 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:10 [    INFO] Request processed (middleware.py:23)
2025-04-29 13:02:10 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:10 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:10 [    INFO] Request processed (middleware.py:23)
2025-04-29 13:02:10 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:10 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:10 [    INFO] Request processed (middleware.py:23)
PASSED                                                                   [ 57%]
tests/test_signup.py::test_signup_invalid_email 
-------------------------------- live log call ---------------------------------
2025-04-29 13:02:10 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:10 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:10 [    INFO] Request processed (middleware.py:23)
2025-04-29 13:02:10 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:10 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:10 [    INFO] Request processed (middleware.py:23)
2025-04-29 13:02:10 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:10 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:10 [    INFO] Request processed (middleware.py:23)
2025-04-29 13:02:10 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:10 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:10 [    INFO] Request processed (middleware.py:23)
2025-04-29 13:02:10 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:10 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:10 [    INFO] Request processed (middleware.py:23)
PASSED                                                                   [ 63%]
tests/test_signup.py::test_signup_password_mismatch 
-------------------------------- live log call ---------------------------------
2025-04-29 13:02:10 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:10 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:10 [    INFO] Request processed (middleware.py:23)
PASSED                                                                   [ 68%]
tests/test_signup.py::test_signup_weak_password 
-------------------------------- live log call ---------------------------------
2025-04-29 13:02:10 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:10 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:10 [    INFO] Request processed (middleware.py:23)
2025-04-29 13:02:10 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:10 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:10 [    INFO] Request processed (middleware.py:23)
2025-04-29 13:02:10 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:10 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:10 [    INFO] Request processed (middleware.py:23)
2025-04-29 13:02:10 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:10 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:10 [    INFO] Request processed (middleware.py:23)
2025-04-29 13:02:10 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:10 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:10 [    INFO] Request processed (middleware.py:23)
PASSED                                                                   [ 73%]
tests/test_signup.py::test_signup_duplicate_email 
-------------------------------- live log call ---------------------------------
2025-04-29 13:02:10 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:11 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:11 [    INFO] Request processed (middleware.py:23)
2025-04-29 13:02:11 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:11 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:11 [    INFO] Request processed (middleware.py:23)
PASSED                                                                   [ 78%]
tests/test_signup.py::test_signup_invalid_json 
-------------------------------- live log call ---------------------------------
2025-04-29 13:02:11 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:11 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:11 [    INFO] Request processed (middleware.py:23)
PASSED                                                                   [ 84%]
tests/test_signup.py::test_signup_email_case_insensitive 
-------------------------------- live log call ---------------------------------
2025-04-29 13:02:11 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:11 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:11 [    INFO] Request processed (middleware.py:23)
2025-04-29 13:02:11 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:11 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:11 [    INFO] Request processed (middleware.py:23)
PASSED                                                                   [ 89%]
tests/test_signup.py::test_signup_email_whitespace 
-------------------------------- live log call ---------------------------------
2025-04-29 13:02:11 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:11 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:11 [    INFO] Request processed (middleware.py:23)
2025-04-29 13:02:11 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:11 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:11 [    INFO] Request processed (middleware.py:23)
PASSED                                                                   [ 94%]
tests/test_signup.py::test_signup_long_inputs 
-------------------------------- live log call ---------------------------------
2025-04-29 13:02:11 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:11 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:11 [    INFO] Request processed (middleware.py:23)
2025-04-29 13:02:11 [    INFO] Request started (middleware.py:37)
2025-04-29 13:02:11 [    INFO] Function signup completed (middleware.py:76)
2025-04-29 13:02:11 [    INFO] Request processed (middleware.py:23)
PASSED                                                                   [100%]

---------- coverage: platform darwin, python 3.9.6-final-0 -----------
Name     Stmts   Miss  Cover   Missing
--------------------------------------
app.py     165     19    88%   68, 76, 92, 158, 189-191, 209-210, 242, 276-278, 286-295
--------------------------------------
TOTAL      165     19    88%


============================== 19 passed in 4.51s ==============================
